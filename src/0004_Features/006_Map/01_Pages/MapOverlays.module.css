/* src/0004_Features/006_Map/01_Pages/MapOverlays.module.css */

/* =============================================================================
   [SECTION 1] 지도 상단 필터 및 컨트롤 UI
   ============================================================================= */

/* 상단 필터 바 (중앙 정렬) */
.topFilterBar {
  position: absolute;
  top: 15px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 20;
  display: flex;
  align-items: center;
  gap: 10px;
  white-space: nowrap;
  width: fit-content;
}

/* 필터 컨테이너 */
.mapFilterContainer {
  display: flex;
  gap: 0.5rem;
  background-color: #ffffff;
  border-radius: 0.375rem;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  border: 1px solid #d1d5db;
  padding: 0.5rem;
}

/* 필터 선택 박스 디자인 */
.filterSelect, .mapFilterSelect {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  
  /* 글자 주변 여백 */
  padding: 0.5rem 2rem 0.5rem 0.75rem; 
  
  font-size: 0.875rem;
  font-weight: 500;
  color: #374151;
  background-color: #ffffff;
  border: 1px solid #d1d5db;
  border-radius: 0.375rem;
  cursor: pointer;
  transition: border-color 0.2s, box-shadow 0.2s;
  
  /* 화살표 아이콘 */
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%236b7280'%3E%3Cpath fill-rule='evenodd' d='M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z' clip-rule='evenodd' /%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 0.5rem center;
  background-size: 1.25em 1.25em;
  
  min-width: 100px;
  height: 2.5rem;
}

.filterSelect:focus, .mapFilterSelect:focus {
  outline: none; border-color: #2563eb; box-shadow: 0 0 0 2px #dbeafe;
}
.filterSelect:hover, .mapFilterSelect:hover {
  border-color: #9ca3af;
}

/* 지도 우측 상단 컨트롤 버튼 그룹 (스카이뷰, 지적편집도 등) */
.mapControlContainer {
  position: absolute; top: 1rem; right: 1rem; z-index: 30;
  display: flex; background-color: #ffffff; border-radius: 0.375rem;
  box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); border: 1px solid #d1d5db;
}
.mapControlButton {
  padding: 0.5rem 1rem; font-size: 0.875rem; font-weight: 500; color: #374151;
  background-color: #ffffff; border: none; cursor: pointer; transition: background-color 0.2s;
}
.mapControlButton:not(:last-child) { border-right: 1px solid #d1d5db; }
.mapControlButton:first-child { border-top-left-radius: 0.375rem; border-bottom-left-radius: 0.375rem; }
.mapControlButton:last-child { border-top-right-radius: 0.375rem; border-bottom-right-radius: 0.375rem; }
.mapControlButton:hover { background-color: #f3f4f6; }
.mapControlButton.active { background-color: #2563eb; color: #ffffff; }

/* =============================================================================
   [SECTION 2] 로드뷰 및 모달
   ============================================================================= */

/* 로드뷰 컨테이너 */
.roadview {
  position: absolute; top: 5rem; right: 1rem; width: 45%; height: 60%; z-index: 30;
  border: 3px solid #ffffff; box-shadow: 0 4px 12px rgba(0,0,0,0.3); border-radius: 0.5rem;
  transition: opacity 0.3s, transform 0.3s; opacity: 0; transform: scale(0.9) translateX(50px); pointer-events: none;
}
.roadviewVisible { opacity: 1; transform: scale(1) translateX(0); pointer-events: auto; }

/* 로드뷰 닫기 버튼 */
.roadviewCloseButton {
  position: absolute; top: 5.3rem; right: 1.3rem; z-index: 31;
  background-color: rgba(0,0,0,0.6); color: white; border: none; border-radius: 50%; width: 2.25rem; height: 2.25rem;
  font-size: 1.25rem; font-weight: 700; cursor: pointer; display: flex; justify-content: center; align-items: center;
  box-shadow: 0 2px 6px rgba(0,0,0,0.4); transition: background-color 0.2s, transform 0.1s;
}
.roadviewCloseButton:hover { background-color: rgba(0,0,0,0.8); transform: scale(1.05); }

/* 컨텍스트 메뉴 (우클릭) */
.contextMenu {
  position: absolute; background-color: white; border-radius: 0.5rem; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); z-index: 1000;
  min-width: 180px; display: flex; flex-direction: column; padding: 0.5rem; border: 1px solid #e5e7eb;
}
.contextMenu button {
  padding: 0.5rem 0.75rem; font-size: 0.875rem; color: #374151; background: none; border: none; text-align: left; cursor: pointer;
  border-radius: 0.25rem; display: flex; align-items: center; gap: 0.5rem; width: 100%;
}
.contextMenu button:hover { background-color: #f3f4f6; }

/* AI 분석 모달 */
.imModalOverlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 50; }
.imModal { background: white; padding: 2rem; border-radius: 0.75rem; width: 90%; max-width: 48rem; max-height: 90%; display: flex; flex-direction: column; gap: 1.5rem; }
.imModalTitle { font-size: 1.5rem; font-weight: 700; border-bottom: 1px solid #e5e7eb; padding-bottom: 0.75rem; }
.imContentScroll { flex-grow: 1; overflow-y: auto; white-space: pre-wrap; }

/* 이미지 뷰어 모달 */
.imageViewerModal { background: #ffffff; padding: 1rem; border-radius: 0.5rem; max-width: 90vw; max-height: 90vh; display: flex; justify-content: center; align-items: center; position: relative; }
.imageViewerModal img { max-width: 100%; max-height: 100%; object-fit: contain; }
.imageViewerCloseButton { position: absolute; top: -1rem; right: -1rem; width: 2.5rem; height: 2.5rem; border-radius: 50%; background-color: #dc2626; color: white; border: 2px solid white; font-weight: bold; font-size: 1.25rem; cursor: pointer; z-index: 100; display: flex; justify-content: center; align-items: center; }

/* =============================================================================
   [SECTION 3] 핀(Pin) 및 오버레이 스타일 (핵심 수정 영역)
   ============================================================================= */

/* 1. 우클릭 시 뜨는 빨간 화살표 핀 (임시 핀) */
.tempPin {
  width: 32px;
  height: 48px;
  pointer-events: none;
  filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));
}

/* 2. 커스텀 핀 (카드형) 공통 스타일 */
.customPin {
  position: relative;
  background-color: white;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 6px 10px;
  font-size: 0.8rem;
  font-weight: 700;
  white-space: nowrap;
  cursor: pointer;
  transition: transform 0.2s, z-index 0.2s;
  border: 1px solid #e5e7eb;
  min-width: 80px;
}
.customPin:hover {
  transform: scale(1.1);
  z-index: 100 !important; /* 호버 시 맨 위로 */
}
/* 말풍선 꼬리 */
.customPin::after {
  content: '';
  position: absolute;
  bottom: -6px;
  left: 50%;
  transform: translateX(-50%);
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  border-top: 6px solid white;
}

/* 3. [개별 매물] 주황색 테마 */
.customPinSingle {
  border: 2px solid #f59e0b; /* Amber-500 */
}
.customPinSingle::after {
  border-top-color: #f59e0b;
}
.pinType {
  font-size: 0.7rem;
  color: #f59e0b;
  margin-bottom: 2px;
}
.pinPrice {
  color: #1f2937;
  font-size: 0.85rem;
}

/* 4. [스택 매물] 초록색 테마 (유저가 직접 묶은 매물) */
.customPinStack {
  border: 2px solid #10b981; /* Emerald-500 */
  background-color: #ecfdf5; /* Emerald-50 */
}
.customPinStack::after {
  border-top-color: #10b981;
}
.stackTitle {
  font-size: 0.75rem;
  color: #047857;
  margin-bottom: 2px;
}
.stackCount {
  font-size: 0.9rem;
  color: #1f2937;
}

/* 5. [자동 클러스터] 파란색 원형 (★ 신규 추가: 줌 아웃 시 자동 묶음) */
.clusterPin {
  width: 50px;
  height: 50px;
  background: rgba(37, 99, 235, 0.95); /* Blue-600 */
  border-radius: 50%;
  border: 3px solid white;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 800;
  font-size: 1.1rem;
  cursor: pointer;
  animation: bounceIn 0.3s ease-out;
  z-index: 50;
}
.clusterPin:hover {
  background: #1d4ed8; /* Blue-700 */
  transform: scale(1.1);
  z-index: 101 !important;
}
/* 클러스터 내부 숫자는 클릭 이벤트 방지 (부모에게 전달) */
.clusterPin span {
  pointer-events: none;
}

/* 클러스터 등장 애니메이션 */
@keyframes bounceIn {
  0% { transform: scale(0); opacity: 0; }
  60% { transform: scale(1.1); }
  100% { transform: scale(1); opacity: 1; }
}

/* 6. [활성화 핀] 빨간색 강조 및 파동 애니메이션 (★ 수정됨) */
@keyframes pulseRed {
  0% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7); }
  70% { box-shadow: 0 0 0 10px rgba(220, 38, 38, 0); }
  100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0); }
}

.activePin {
  /* 빨간색 테두리와 배경 */
  border: 2px solid #dc2626 !important; /* Red-600 */
  background-color: white !important;
  color: #1f2937 !important;
  
  /* 크기 확대 및 최상단 배치 */
  transform: scale(1.2) !important; 
  z-index: 999 !important;
  
  /* 파동 애니메이션 */
  animation: pulseRed 1.5s infinite;
}

/* 활성화된 핀의 꼬리 색상 변경 */
.activePin::after {
  border-top-color: #dc2626 !important;
}

/* 활성화 시 내부 텍스트 색상 강제 지정 */
.activePin .pinType, 
.activePin .pinPrice, 
.activePin .stackTitle, 
.activePin .stackCount {
  color: #1f2937 !important;
  font-weight: 800 !important;
}